<!-- File: Sidebar.html -->
<? /** @fileoverview Sidebar template con checkboxes para operarios y semanas */ ?>
<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: sans-serif; padding: 10px; }
    label { display: block; margin-top: 8px; }
    .ops { max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 5px; }
    button { width: 100%; margin-top: 12px; }
  </style>
</head>
<body>
  <h3>Filtrar informe</h3>

  <!-- Cliente -->
  <label>Cliente:</label>
  <select id="cliente">
    <option value="">(Todos)</option>
    <? for (let c of clientes) { ?>
      <option value="<?= c ?>"><?= c ?></option>
    <? } ?>
  </select>

  <!-- Semanas -->
  <label>Semanas:</label>
  <div class="ops">
    <? for (let s of semanas) { ?>
      <label>
        <input type="checkbox" class="semana" value="<?= s ?>" />
        <?= s ?>
      </label>
    <? } ?>
  </div>

  <!-- Operarios -->
  <label>Operarios:</label>
  <div class="ops">
    <? for (let o of operarios) { ?>
      <label>
        <input type="checkbox" class="operario" value="<?= o ?>" />
        <?= o ?>
      </label>
    <? } ?>
  </div>

  <!-- BotÃ³n -->
  <button type="button" onclick="submitFilters()">Generar informe</button>

  <script>
    function submitFilters() {
      const cliente  = document.getElementById('cliente').value;
      const semanas  = Array.from(document.querySelectorAll('.semana'))
                            .filter(ch => ch.checked)
                            .map(ch => ch.value);
      const ops      = Array.from(document.querySelectorAll('.operario'))
                            .filter(ch => ch.checked)
                            .map(ch => ch.value);

      google.script.run
        .withSuccessHandler(() => google.script.host.close())
        .withFailureHandler(err => alert('Error: ' + err.message))
        .generateReport({
          cliente:    cliente,
          semanas:    semanas,
          operarios:  ops
        });
    }
  </script>
</body>
</html>
